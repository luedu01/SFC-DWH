REPLACE VIEW PROD_DWH_CONSULTA_SA.ENDEU_INDIV

    (
    Tipo_IDentificacion,
    Numero_IDentificacion,
    Ent_ID,
    Codigo_Cidt,
    Pau_ID,
    Fecha_Corte,
    Clasificacion,
    Calificacion,
    Tipo_Garantia,
    Clase_Garantia,
    Garantia,
    Fecha_Garantia,
    Ent_ID_Se_Origino_En,
    Segmento,
    Numero_Operaciones_ML,
    Numero_Operaciones_ME,
    Capital_ML,
    Capital_ME,
    Intereses_ML,
    Intereses_ME,
    Otros_Conceptos_ML,
    Otros_Conceptos_ME,
    Total_ML,
    Total_ME,
    Contingencia_ML,
    Contingencia_ME,
    Provision_Total_ML,
    Provision_Total_ME,
    Garantia_ML,
    Garantia_ME,
    Capital_Esperado_ML,
    Capital_Esperado_ME,
    Intereses_Esperado_ML,
    Intereses_Esperado_ME,
    Capital_Recibido_ML,
    Capital_Recibido_ME,
    Intereses_Recibido_ML,
    Intereses_Recibido_ME,
    Redescuento,
    Fecha_Inicial,
    Fecha_Vencimiento,
    Tasa_Credito,
    Dias_Mora,
    Modelo,
    Probabilidad_Incumplimiento,
    Provision_Prociclica_ML,
    Provision_Prociclica_ME,
    Provision_Contraciclica_ML,
    Provision_Contraciclica_ME,
    Exposicion_ML,
    Exposicion_ME,
    Tasa_Descuento_ML,
    Tasa_Descuento_ME,
    Perdida_Incumplimiento,
    Ind_Nvo,
    Ind_Cmp,
    Califica_Ant,
    Oacs_ML_Ant,
    Oacs_ME_Ant,
    Capital_ML_Ant,
    Capital_ME_Ant,
    Intereses_ML_Ant,
    Intereses_ME_Ant,
    Otros_ML_Ant,
    Otros_ME_Ant,
    Total_ML_Ant,
    Total_ME_Ant
    )
    AS 
    LOCKING ROW FOR ACCESS
    SELECT 
        ENFI_TIPIDE,
        PROD_DWH_CONSULTA_SA.AnonimizaData(ENFI_NUMIDE) AS ENFI_NUMIDE,
        ENFI_ENT_ID,
        ENFI_CODCIDT,
        ENFI_PAU_ID,
        ENFI_FECCORTE,
        ENFI_CLASIFICA,
        ENFI_CALIFICA,
        ENFI_TIPO_GARANTIA,
        ENFI_CLASE_GARANTIA,
        ENFI_GARANTIA,
        ENFI_FCH_GARANTIA,
        ENFI_ENT_ID_SE_ORIGINO_EN,
        
        CASE
            WHEN ENFI_PROBABILIDAD IN (1.53, 2.24, 9.55, 12.24, 19.77)  THEN ('GE')
            WHEN ENFI_PROBABILIDAD IN (1.51, 2.40, 11.65, 14.64, 23.09) THEN ('ME')
            WHEN ENFI_PROBABILIDAD IN (4.18, 5.30, 18.56, 22.73, 32.50) THEN ('PE')
            WHEN ENFI_PROBABILIDAD IN (5.27, 6.39, 18.72, 22.00, 32.21) THEN ('UN')
            WHEN ENFI_PROBABILIDAD =100  THEN ('INC')
        ELSE '-'
        END SEGMENTO,
            ENFI_OACS_ML,
            ENFI_OACS_ME,
            ENFI_CAPITAL_ML,
            ENFI_CAPITAL_ME,
            ENFI_INTERESES_ML,
            ENFI_INTERESES_ME,
            ENFI_OTROS_ML,
            ENFI_OTROS_ME,
            ENFI_TOTAL_ML,
            ENFI_TOTAL_ME,
            ENFI_CONTINGENCIA_ML,
            ENFI_CONTINGENCIA_ME,
            ENFI_PROVISIONES_ML,
            ENFI_PROVISIONES_ME,
            ENFI_GARANTIA_ML,
            ENFI_GARANTIA_ME,
            ENFI_K_ESPERADO_ML,
            ENFI_K_ESPERADO_ME,
            ENFI_I_ESPERADO_ML,
            ENFI_I_ESPERADO_ME,
            ENFI_K_RECIBIDO_ML,
            ENFI_K_RECIBIDO_ME,
            ENFI_I_RECIBIDO_ML,
            ENFI_I_RECIBIDO_ME,
            ENFI_REDESCUENTO,
            ENFI_FCH_INICIAL,
            ENFI_FCH_FINAL,
            ENFI_TASA_CREDITO,
            ENFI_DIAS_MORA,
            ENFI_MODELO,
            ENFI_PROBABILIDAD,
            ENFI_PROVISION_IND_ML,
            ENFI_PROVISION_IND_ME,
            ENFI_PROVISION_ANT_ML,
            ENFI_PROVISION_ANT_ME,
            ENFI_EXPOSICION_ML,
            ENFI_EXPOSICION_ME,
            ENFI_TASA_DSCTO_ML,
            ENFI_TASA_DSCTO_ME,
            ENFI_PERDIDA,
            ENFI_IND_NVO,
            ENFI_IND_CMP,
            ENFI_CALIFICA_ANT,
            ENFI_OACS_ML_ANT,
            ENFI_OACS_ME_ANT,
            ENFI_CAPITAL_ML_ANT,
            ENFI_CAPITAL_ME_ANT,
            ENFI_INTERESES_ML_ANT,
            ENFI_INTERESES_ME_ANT,
            ENFI_OTROS_ML_ANT,
            ENFI_OTROS_ME_ANT,
            ENFI_TOTAL_ML_ANT,
            ENFI_TOTAL_ME_ANT
        FROM PROD_DWH_DATA.ENDEU_INDIV;